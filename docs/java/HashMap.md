### HashMap
是由**数组**和**链表**组成的数据结构  
Java8之后引入**红黑树**  
put元素的时候,先将key进行hash,再进行位运算,算出要插入的位置。因为hash有随机性,所以当两个key值计算出来的hash值在同一个值上,就会形成链表。  

Q1:说到链表我想问一下，你知道新的Entry节点在插入链表的时候，是怎么插入的么？==  
A1:在Java8之前使用的是头插法,作者认为后来的值被查找的可能性更大,可以提升执行效率。   在java8之后，都是采用尾部插入了。  

Q2:为什么会采用尾部插入呢？  
A2:数组容量是有限的，数据多次插入的，到达一定的数量就会进行扩容，也就是resize。==在什么时候会resize? 有2个因素：  
①负载因子(default:0.75)  
②HashMap当前长度  
扩容的步骤分为两步:  

-  扩容：创建一个新的Entry空数组，长度是原数组的2倍。
-   ReHash：遍历原Entry数组，把所有的Entry重新Hash到新数组。  

为什么不直接复制到新的数组呢?  
因为计算Hash的时候,和原来的长度有关,长度变了,计算规则自然就变了。  
回到原来的问题,为什么采用尾部插入?  
因为resize的赋值方式，也就是使用了单链表的头插入方式，同一位置上新元素总会被放在链表的头部位置，在旧数组中同一条Entry链上的元素，通过重新计算索引位置后，有可能被放到了新数组的不同位置上。一旦几个线程都调整完成，就可能出现环形链表  

Q3:HashMap的默认初始化长度是多少？为什么是16?  
1<<4就是16  
  这样是为了位运算的方便，位与运算比算数计算的效率高了很多，之所以选择16，是为了服务将Key映射到index的算法。从而实现均匀分布。  

  Q4：HashMap线程不安全的，那你能跟我聊聊你们是怎么处理HashMap在线程安全的场景么?  
  A4: 使用ConcurrentHashMap  


  HashMap常见面试题：

    HashMap的底层数据结构？
    
    HashMap的存取原理？
    
    Java7和Java8的区别？
    
    为啥会线程不安全？
    
    有什么线程安全的类代替么?
    
    默认初始化大小是多少？为啥是这么多？为啥大小都是2的幂？
    
    HashMap的扩容方式？负载因子是多少？为什是这么多？
    
    HashMap的主要参数都有哪些？
    
    HashMap是怎么处理hash碰撞的？
    
    hash的计算规则？